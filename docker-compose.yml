version: "3.3"

services:
  web:
    build:
      context: .
      args:
        blduser: notused
    # no user here because no need to run as something other than root user
    command: [flask, run, --host=0.0.0.0]
    ports:
      - 8000:5000

  worker:
    build:
      context: .
      args:
        blduser: celeryworker
    # sets the user of the container - removes RuntimeWarning for Celery
    user: celeryworker  #  user must match blduser arg
    command: [celery, worker, --app=lrnflsk.celery_worker.celery, --concurrency=1]
